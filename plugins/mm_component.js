// 栏目
import bar_action from '@/components/mm/bar/bar_action.vue';
import bar_ad from '@/components/mm/bar/bar_ad.vue';
import bar_buy from '@/components/mm/bar/bar_buy.vue';
import bar_chat from '@/components/mm/bar/bar_chat.vue';
import bar_count from '@/components/mm/bar/bar_count.vue';
import bar_filter from '@/components/mm/bar/bar_filter.vue';
import bar_menu from '@/components/mm/bar/bar_menu.vue';
import bar_search from '@/components/mm/bar/bar_search.vue';
import bar_sort from '@/components/mm/bar/bar_sort.vue';
import bar_tab from '@/components/mm/bar/bar_tab.vue';
import bar_title from '@/components/mm/bar/bar_title.vue';
import bar_tool from '@/components/mm/bar/bar_tool.vue';
import bar_user from '@/components/mm/bar/bar_user.vue';


// 列表项
import item_address from '@/components/mm/item/item_address.vue';
import item_analyse from '@/components/mm/item/item_analyse.vue';
import item_article from '@/components/mm/item/item_article.vue';
import item_audio from '@/components/mm/item/item_audio.vue';
import item_base from '@/components/mm/item/item_base.vue';
import item_chat from '@/components/mm/item/item_chat.vue';
import item_comment from '@/components/mm/item/item_comment.vue';
import item_contact from '@/components/mm/item/item_contact.vue';
import item_count from '@/components/mm/item/item_count.vue';
import item_date from '@/components/mm/item/item_date.vue';
import item_forum from '@/components/mm/item/item_forum.vue';
import item_goods from '@/components/mm/item/item_goods.vue';
import item_image from '@/components/mm/item/item_image.vue';
import item_media from '@/components/mm/item/item_media.vue';
import item_message from '@/components/mm/item/item_message.vue';
import item_music from '@/components/mm/item/item_music.vue';
import item_news from '@/components/mm/item/item_news.vue';
import item_number from '@/components/mm/item/item_number.vue';
import item_order from '@/components/mm/item/item_order.vue';
import item_question from '@/components/mm/item/item_question.vue';
import item_recommend from '@/components/mm/item/item_recommend.vue';
import item_reply from '@/components/mm/item/item_reply.vue';
import item_tag from '@/components/mm/item/item_tag.vue';
import item_text from '@/components/mm/item/item_text.vue';
import item_thread from '@/components/mm/item/item_thread.vue';
import item_trend from '@/components/mm/item/item_trend.vue';
import item_type from '@/components/mm/item/item_type.vue';
import item_user from '@/components/mm/item/item_user.vue';
import item_video from '@/components/mm/item/item_video.vue';

// 列表
import list_address from '@/components/mm/list/list_address.vue';
import list_analyse from '@/components/mm/list/list_analyse.vue';
import list_article from '@/components/mm/list/list_article.vue';
import list_audio from '@/components/mm/list/list_audio.vue';
import list_base from '@/components/mm/list/list_base.vue';
import list_chat from '@/components/mm/list/list_chat.vue';
import list_comment from '@/components/mm/list/list_comment.vue';
import list_contact from '@/components/mm/list/list_contact.vue';
import list_count from '@/components/mm/list/list_count.vue';
import list_date from '@/components/mm/list/list_date.vue';
import list_forum from '@/components/mm/list/list_forum.vue';
import list_goods from '@/components/mm/list/list_goods.vue';
import list_image from '@/components/mm/list/list_image.vue';
import list_media from '@/components/mm/list/list_media.vue';
import list_message from '@/components/mm/list/list_message.vue';
import list_music from '@/components/mm/list/list_music.vue';
import list_news from '@/components/mm/list/list_news.vue';
import list_number from '@/components/mm/list/list_number.vue';
import list_order from '@/components/mm/list/list_order.vue';
import list_question from '@/components/mm/list/list_question.vue';
import list_recommend from '@/components/mm/list/list_recommend.vue';
import list_reply from '@/components/mm/list/list_reply.vue';
import list_tag from '@/components/mm/list/list_tag.vue';
import list_text from '@/components/mm/list/list_text.vue';
import list_thread from '@/components/mm/list/list_thread.vue';
import list_trend from '@/components/mm/list/list_trend.vue';
import list_type from '@/components/mm/list/list_type.vue';
import list_user from '@/components/mm/list/list_user.vue';
import list_video from '@/components/mm/list/list_video.vue';

// 导航
import nav_bottom from '@/components/mm/nav/nav_bottom.vue';
import nav_main from '@/components/mm/nav/nav_main.vue';
import nav_path from '@/components/mm/nav/nav_path.vue';
import nav_quick from '@/components/mm/nav/nav_quick.vue';
import nav_side from '@/components/mm/nav/nav_side.vue';
import nav_top from '@/components/mm/nav/nav_top.vue';
import nav_user from '@/components/mm/nav/nav_user.vue';

// 轮播
import swiper_card from '@/components/mm/swiper/swiper_card.vue';
import swiper_rotate_card from '@/components/mm/swiper/swiper_rotate_card.vue';
import swiper_image from '@/components/mm/swiper/swiper_image.vue';
import swiper_menu from '@/components/mm/swiper/swiper_menu.vue';
import swiper_page from '@/components/mm/swiper/swiper_page.vue';
import swiper_vertical_page from '@/components/mm/swiper/swiper_vertical_page.vue';
import swiper_text from '@/components/mm/swiper/swiper_text.vue';

// 表格
import table_coin from '@/components/mm/table/table_coin.vue';
import table_stock from '@/components/mm/table/table_stock.vue';

// 图表
import chart_bar from '@/components/mm/chart/chart_bar.vue';
import chart_depth from '@/components/mm/chart/chart_depth.vue';
import chart_k from '@/components/mm/chart/chart_k.vue';
import chart_line from '@/components/mm/chart/chart_line.vue';
import chart_panel from '@/components/mm/chart/chart_panel.vue';
import chart_pie from '@/components/mm/chart/chart_pie.vue';

// 拓展
import expand_drag from '@/components/mm/expand/expand_drag.vue';
import expand_sptite from '@/components/mm/expand/expand_sptite.vue';
import expand_pay from '@/components/mm/expand/expand_pay.vue';
import expand_pre from '@/components/mm/expand/expand_pre.vue';
import expand_qrcode from '@/components/mm/expand/expand_qrcode.vue';

/* === 创建全局组件 === */
export default {
  install(Vue, options) {

    /**
     * 转换时间
     * @param {String} timeStr 时间字符串
     * @param {String} format 转换格式
     * @return {String} 返回转换后的结果
     */
    Vue.prototype.$to_time = function(timeStr, format) {
      var time = timeStr.toTime();
      if (format) {
        return time.toStr(format);
      } else {
        var date = time.toStr("yyyy-MM-dd");
        var now = new Date();
        if (date == now.toStr("yyyy-MM-dd")) {
          return time.toStr("hh:mm")
        } else if (date == now.addDays(-1).toStr("yyyy-MM-dd")) {
          return "昨天" + time.toStr("hh:mm")
        } else if (time.toStr("yyyy") == now.toStr("yyyy")) {
          return time.toStr("MM-dd");
        } else {
          return date;
        }
      }
    };

    // 自定义拖动
    Vue.directive('drag',
      function(el, binding) {
        el.onmousedown = function(e) {
          let odiv = el; //获取当前元素
          let firstTime = '',
            lastTime = '';
          // 给当前元素添加属性，用于元素状态的判断
          odiv.setAttribute('ele-flag', false)
          odiv.setAttribute('draging-flag', true)

          e.preventDefault();
          let bw = document.body.clientWidth;
          let bh = document.body.clientHeight;
          //鼠标按下，计算当前元素距离可视区的距离
          let disX = e.clientX - el.offsetLeft;
          let disY = e.clientY - el.offsetTop;

          // 计算两边坐标
          document.onmousemove = function(e) {
            let l = 0,
              t = 0;
            // 拖动边界
            if (e.clientX >= bw) {
              l = bw - disX;
            } else if (e.clientX <= 0) {
              {
                l = 0 - disX;
              }
            } else {
              l = e.clientX - disX;
            }
            if (e.clientY >= bh) {
              t = bh - disY;
            } else if (e.clientY <= 0) {
              t = 0 - disY;
            } else {
              t = e.clientY - disY;
            }
            //移动当前元素
            el.style.left = l + 'px';
            el.style.top = t + 'px';
          };
          // 鼠标停止移动时，事件移除
          document.onmouseup = function(e) {
            document.onmousemove = null;
            document.onmouseup = null;
            console.log({
              x: e.clientX,
              y: e.clientY
            });
            lastTime = new Date().getTime();
            if ((lastTime - firstTime) > 200) {
              odiv.setAttribute('ele-flag', true)
              event.stopPropagation()
            }
            setTimeout(function() {
              odiv.setAttribute('draging-flag', false)
            }, 100)
          };
        };
      }
    );

    // 栏目组件
    Vue.component('bar_action', bar_action);
    Vue.component('bar_ad', bar_ad);
    Vue.component('bar_buy', bar_buy);
    Vue.component('bar_chat', bar_chat);
    Vue.component('bar_count', bar_count);
    Vue.component('bar_filter', bar_filter);
    Vue.component('bar_menu', bar_menu);
    Vue.component('bar_search', bar_search);
    Vue.component('bar_sort', bar_sort);
    Vue.component('bar_tab', bar_tab);
    Vue.component('bar_title', bar_title);
    Vue.component('bar_tool', bar_tool);
    Vue.component('bar_user', bar_user);

    // 列表项
    Vue.component('item_address', item_address);
    Vue.component('item_analyse', item_analyse);
    Vue.component('item_article', item_article);
    Vue.component('item_audio', item_audio);
    Vue.component('item_base', item_base);
    Vue.component('item_chat', item_chat);
    Vue.component('item_comment', item_comment);
    Vue.component('item_contact', item_contact);
    Vue.component('item_count', item_count);
    Vue.component('item_date', item_date);
    Vue.component('item_forum', item_forum);
    Vue.component('item_goods', item_goods);
    Vue.component('item_image', item_image);
    Vue.component('item_media', item_media);
    Vue.component('item_message', item_message);
    Vue.component('item_music', item_music);
    Vue.component('item_news', item_news);
    Vue.component('item_number', item_number);
    Vue.component('item_order', item_order);
    Vue.component('item_question', item_question);
    Vue.component('item_recommend', item_recommend);
    Vue.component('item_reply', item_reply);
    Vue.component('item_tag', item_tag);
    Vue.component('item_text', item_text);
    Vue.component('item_thread', item_thread);
    Vue.component('item_trend', item_trend);
    Vue.component('item_type', item_type);
    Vue.component('item_user', item_user);
    Vue.component('item_video', item_video);

    // 列表
    Vue.component('list_address', list_address);
    Vue.component('list_analyse', list_analyse);
    Vue.component('list_article', list_article);
    Vue.component('list_audio', list_audio);
    Vue.component('list_base', list_base);
    Vue.component('list_chat', list_chat);
    Vue.component('list_comment', list_comment);
    Vue.component('list_contact', list_contact);
    Vue.component('list_count', list_count);
    Vue.component('list_date', list_date);
    Vue.component('list_forum', list_forum);
    Vue.component('list_goods', list_goods);
    Vue.component('list_image', list_image);
    Vue.component('list_media', list_media);
    Vue.component('list_message', list_message);
    Vue.component('list_music', list_music);
    Vue.component('list_news', list_news);
    Vue.component('list_number', list_number);
    Vue.component('list_order', list_order);
    Vue.component('list_question', list_question);
    Vue.component('list_recommend', list_recommend);
    Vue.component('list_reply', list_reply);
    Vue.component('list_tag', list_tag);
    Vue.component('list_text', list_text);
    Vue.component('list_thread', list_thread);
    Vue.component('list_trend', list_trend);
    Vue.component('list_type', list_type);
    Vue.component('list_user', list_user);
    Vue.component('list_video', list_video);

    // 导航
    Vue.component('nav_bottom', nav_bottom);
    Vue.component('nav_main', nav_main);
    Vue.component('nav_path', nav_path);
    Vue.component('nav_quick', nav_quick);
    Vue.component('nav_side', nav_side);
    Vue.component('nav_top', nav_top);
    Vue.component('nav_user', nav_user);

    // 轮播
    Vue.component('swiper_card', swiper_card);
    Vue.component('swiper_rotate_card', swiper_rotate_card);
    Vue.component('swiper_image', swiper_image);
    Vue.component('swiper_menu', swiper_menu);
    Vue.component('swiper_page', swiper_page);
    Vue.component('swiper_vertical_page', swiper_vertical_page);
    Vue.component('swiper_text', swiper_text);

    // 图表
    Vue.component('chart_bar', chart_bar);
    Vue.component('chart_depth', chart_depth);
    Vue.component('chart_k', chart_k);
    Vue.component('chart_line', chart_line);
    Vue.component('chart_panel', chart_panel);
    Vue.component('chart_pie', chart_pie);

    //  拓展
    Vue.component('expand_drag', expand_drag);
    Vue.component('expand_sptite', expand_sptite);
    Vue.component('expand_qrcode', expand_qrcode);
    Vue.component('expand_pre', expand_pre);
  }
}
